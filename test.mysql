SHOW DATABASE;

SHOW TABLES;

//////////////////////// mark table ////////////////////

CREATE TABLE mark (
  Mark_id VARCHAR(15) NOT NULL,
  student_id VARCHAR(20) NOT NULL,
  course_code VARCHAR(15) NOT NULL,
  exam_id INT NOT NULL,
  Quiz_01 DECIMAL(5,2),
  Quiz_02 DECIMAL(5,2),
  Quiz_03 DECIMAL(5,2),
  Assessment_01 DECIMAL(5,2),
  Mid_Practical DECIMAL(5,2),
  Mid_Theory DECIMAL(5,2),
  Final_Theory DECIMAL(5,2),
  Final_Practical DECIMAL(5,2),
  Type ENUM('Theory', 'Practical', 'Both') NOT NULL,

  PRIMARY KEY( Mark_id),		
  FOREIGN KEY (student_id) REFERENCES student(Registration_No) ON DELETE CASCADE,
  FOREIGN KEY (course_code) REFERENCES course_unit(Course_code) ON DELETE CASCADE,
  FOREIGN KEY (exam_id) REFERENCES exam(Exam_Id) ON DELETE CASCADE
);
UPDATE mark m
JOIN course_unit c
ON m.Course_code =c.Course_code
SET m.Type=c.Type;


INSERT INTO mark 
VALUES
('M001', 'tg/2023/0002', 'ENG1222', 1, 68.36, 90.77, 70.20, 94.51, 0.00, 96.29, 80.73, 0.00, 'Theory'),
('M002', 'tg/2023/0002', 'ICT1212', 8, 95.51, 81.66, 90.93, 84.17, 0.00, 48.69, 72.73, 0.00, 'Theory'),
('M003', 'tg/2023/0002', 'ICT1222', 2, 91.73, 89.60, 86.23, 55.32, 99.33, 87.81, 53.08, 77.13, 'Practical'),
('M004', 'tg/2023/0002', 'ICT1233', 22, 78.30, 78.69, 81.72, 80.52, 81.99, 90.69, 47.50, 75.33, 'Both'),
('M005', 'tg/2023/0002', 'ICT1242', 29, 89.41, 71.21, 45.42, 87.93, 0.00, 46.82, 60.26, 0.00, 'Theory'),
('M006', 'tg/2023/0002', 'ICT1253', 36, 60.83, 93.46, 99.24, 75.76, 77.20, 83.38, 74.42, 77.84, 'Both'),
('M007', 'tg/2023/0002', 'TCS1212', 43, 76.44, 91.06, 82.95, 78.80, 0.00, 81.96, 86.52, 0.00, 'Theory'),
('M008', 'tg/2023/0002', 'TMS1233', 50, 87.27, 74.16, 97.73, 70.57, 0.00, 90.35, 80.05, 0.00, 'Theory');


//////////////////////////////student result table/////////////////////

CREATE TABLE student_result (
  Result_Id INT NOT NULL AUTO_INCREMENT,
  student_id VARCHAR(20) NOT NULL,
  course_code VARCHAR(15) NOT NULL,
  Semester VARCHAR(20) DEFAULT 'Semester 2',
  CA_marks DECIMAL(5,2),
  Final_Marks DECIMAL(5,2),
  Final_Grade CHAR(15),
  Result_Status ENUM('PASS','FAIL','MC','WH') DEFAULT 'PASS',
  SGPA DECIMAL(5,2),
  CGPA DECIMAL(5,2),

  PRIMARY KEY(Result_Id),
  FOREIGN KEY (student_id) REFERENCES student(Registration_No) ON DELETE CASCADE,
  FOREIGN KEY (course_code) REFERENCES course_unit(Course_code)ON DELETE CASCADE);

////////////////////////////// DATA ////////////////////////////////////////

INSERT INTO student_result
VALUES
(1, 'tg/2023/0002', 'ENG1222', 'Semester 2', 84.49, NULL, 'A-', 'PASS', NULL, NULL),
(2, 'tg/2023/0002', 'ICT1212', 'Semester 2', 89.01, NULL, 'A', 'PASS', NULL, NULL),
(3, 'tg/2023/0002', 'ICT1222', 'Semester 2', 88.54, NULL, 'A', 'PASS', NULL, NULL),
(4, 'tg/2023/0002', 'ICT1233', 'Semester 2', 83.37, NULL, 'A-', 'PASS', NULL, NULL),
(5, 'tg/2023/0002', 'ICT1242', 'Semester 2', 82.85, NULL, 'A-', 'PASS', NULL, NULL),
(6, 'tg/2023/0002', 'ICT1253', 'Semester 2', 86.23, NULL, 'A', 'PASS', NULL, NULL),
(7, 'tg/2023/0002', 'TCS1212', 'Semester 2', 81.40, NULL, 'A-', 'PASS', NULL, NULL),
(8, 'tg/2023/0002', 'TMS1233', 'Semester 2', 91.28, NULL, 'A+', 'PASS', NULL, NULL),
(9, 'tg/2023/0003', 'ENT1212', 'Semester 2', 86.26, NULL, 'A', 'PASS', NULL, NULL),
(10, 'tg/2023/0003', 'TMS1213', 'Semester 2', 87.48, NULL, 'A', 'PASS', NULL, NULL);



